Quercetin 3-O-Rhamnoside
Resveratrol 3-O-Glucoside
Procyanidin Dimer B1
Procyanidin Dimer B2
Procyanidin Dimer B4
Ferulaldehyde
Sinapaldehyde
Caffeoyl Tartaric Acid
Feruloyl Tartaric Acid
P-Coumaroyl Tartaric Acid
Cyanidin 3-O-(6''-Acetyl-Glucoside)
Cyanidin 3-O-Glucoside
Delphinidin 3-O-(6''-Acetyl-Glucoside)
Delphinidin 3-O-(6''-P-Coumaroyl-Glucoside)
Delphinidin 3-O-Glucoside
Malvidin 3-O-(6''-Acetyl-Glucoside)
Malvidin 3-O-(6''-Caffeoyl-Glucoside)
Malvidin 3-O-(6''-P-Coumaroyl-Glucoside)
Malvidin 3-O-Glucoside
Peonidin 3-O-(6''-Acetyl-Glucoside)
Peonidin 3-O-(6''-P-Coumaroyl-Glucoside)
Peonidin 3-O-Glucoside
Petunidin 3-O-(6''-Acetyl-Glucoside)
Petunidin 3-O-(6''-P-Coumaroyl-Glucoside)
Petunidin 3-O-Glucoside
Pigment A
Pinotin A
Vitisin A
Dihydromyricetin 3-O-Rhamnoside
Dihydroquercetin 3-O-Rhamnoside
Procyanidin Dimer B5
Procyanidin Dimer B7
Procyanidin Trimer C1
Procyanidin Trimer Eec
Procyanidin Trimer T2
Isorhamnetin 3-O-Glucoside
Kaempferol 3-O-Glucoside
Rhamnetin
Protocatechuic Aldehyde
Syringaldehyde
2,3-Dihydroxybenzoic Acid
Gallic Acid Ethyl Ester
2,5-Di-S-Glutathionyl Caftaric Acid
D-Viniferin
E-Viniferin
Pallidol
Piceatannol
Piceatannol 3-O-Glucoside
Pterostilbene
Eriodictyol
Tangeretin
Galangin
Arctigenin
Isolariciresinol
Lariciresinol
Pinoresinol
Syringaresinol
Trachelogenin
02 Mers
03 Mers
04-06 Mers
07-10 Mers
Polymers (>10 Mers)
Ellagic Acid
3-Caffeoylquinic Acid
Cinnamic Acid
5-Heneicosylresorcinol
5-Heptadecylresorcinol
5-Nonadecylresorcinol
5-Pentacosylresorcinol
5-Tricosylresorcinol
5-Nonadecenylresorcinol
5-Heneicosenylresorcinol
5-Pentacosenylresorcinol
5-Tricosenylresorcinol
5-Pentadecylresorcinol
Medioresinol
Apigenin 6-C-Glucoside
5-5'-Dehydrodiferulic Acid
5-8'-Benzofuran Dehydrodiferulic Acid
5-8'-Dehydrodiferulic Acid
8-O-4'-Dehydrodiferulic Acid
Apigenin 6,8-C-Arabinoside-C-Glucoside
Apigenin 6,8-C-Galactoside-C-Arabinoside
Avenanthramide 2f
Avenanthramide 2c
Avenanthramide 2p
Avenanthramide K
(-)-Epicatechin-(2a-7)(4a-8)-Epicatechin 3-O-Galactoside
Cinnamtannin A2
Mellein
Phenol
Benzoic Acid
Caffeoyl Aspartic Acid
P-Coumaroyl Tyrosine
2-S-Glutathionyl Caftaric Acid
3-P-Coumaroylquinic Acid
Cyanidin 3-O-(6''-Dioxalyl-Glucoside)
Cyanidin 3-O-(6''-Malonyl-Glucoside)
Cyanidin 3-O-(6''-P-Coumaroyl-Glucoside)
Cyanidin 3-O-Arabinoside
Cyanidin 3-O-Galactoside
Cyanidin 3-O-Rutinoside
Cyanidin 3-O-Xyloside
Delphinidin 3-O-Arabinoside
Delphinidin 3-O-Galactoside
Malvidin 3-O-Arabinoside
Malvidin 3-O-Galactoside
Peonidin 3-O-Arabinoside
Peonidin 3-O-Galactoside
Petunidin 3-O-Arabinoside
Petunidin 3-O-Galactoside
Myricetin 3-O-Rhamnoside
Quercetin 3-O-Acetyl-Rhamnoside
Quercetin 3-O-Galactoside
Quercetin 3-O-Glucosyl-Xyloside
Quercetin 3-O-Xyloside
Quercetin 3-O-Xylosyl-Glucuronide
Morin
7-Hydroxymatairesinol
7-Hydroxysecoisolariciresinol
7-Oxomatairesinol
Conidendrin
Cyclolariciresinol
Dimethylmatairesinol
Lariciresinol-Sesquilignan
Nortrachelogenin
Secoisolariciresinol-Sesquilignan
Sesamin
Anthocyanins, Total
Cyanidin 3,5-O-Diglucoside
Cyanidin 3-O-(6''-Caffeoyl-Glucoside)
Cyanidin 3-O-Glucosyl-Rutinoside
Cyanidin 3-O-Sambubioside
Cyanidin 3-O-Sambubioside 5-O-Glucoside
Cyanidin 3-O-Sophoroside
Cyanidin 3-O-Xylosyl-Rutinoside
Delphinidin 3-O-Rutinoside
Delphinidin 3-O-Sambubioside
Delphinidin 3-O-Xyloside
Pelargonidin 3-O-Arabinoside
Pelargonidin 3-O-Galactoside
Pelargonidin 3-O-Glucoside
Pelargonidin 3-O-Rutinoside
Pelargonidin 3-O-Sambubioside
Peonidin 3-O-Rutinoside
Petunidin 3-O-Rutinoside
Myricetin 3-O-Arabinoside
4-Hydroxybenzoic Acid 4-O-Glucoside
5-O-Galloylquinic Acid
Gallic Acid 4-O-Glucoside
Galloyl Glucose
Protocatechuic Acid 4-O-Glucoside
4-P-Coumaroylquinic Acid
5-P-Coumaroylquinic Acid
Caffeic Acid 4-O-Glucoside
Caffeoyl Glucose
Ferulic Acid 4-O-Glucoside
Feruloyl Glucose
P-Coumaric Acid 4-O-Glucoside
P-Coumaroyl Glucose
Myricetin 3-O-Glucoside
Myricetin 3-O-Rutinoside
Kaempferol 3-O-Galactoside
Quercetin 3-O-Glucuronide
Cyanidin 3-O-(6''-Acetyl-Galactoside)
Delphinidin 3-O-(6''-Acetyl-Galactoside)
Malvidin 3-O-(6''-Acetyl-Galactoside)
Peonidin 3-O-(6''-Acetyl-Galactoside)
Petunidin 3-O-(6''-Acetyl-Galactoside)
Cyanidin
Pelargonidin 3-O-(6''-Malonyl-Glucoside)
Pelargonidin 3-O-(6''-Succinyl-Glucoside)
Pelargonidin 3-O-Glucosyl-Rutinoside
Pelargonidin 3-O-Sophoroside
Isorhamnetin 3-O-Glucuronide
Ellagic Acid Acetyl-Arabinoside
Ellagic Acid Acetyl-Xyloside
Ellagic Acid Arabinoside
Lambertianin C
Sanguiin H-6
Cyanidin 3-O-(6''-Succinyl-Glucoside)
Pelargonidin
Ellagic Acid Glucoside
Kaempferol 3-O-Rutinoside
3-Sinapoylquinic Acid
4-Sinapoylquinic Acid
5-Sinapoylquinic Acid
Malvidin 3,5-O-Diglucoside
Peonidin
3-Hydroxyphloretin 2'-O-Glucoside
3-Hydroxyphloretin 2'-O-Xylosyl-Glucoside
Phloretin 2'-O-Xylosyl-Glucoside
Phloridzin
P-Coumaroylquinic Acid
Arbutin
(+)-Catechin 3-O-Gallate
(+)-Gallocatechin 3-O-Gallate
3,4-Dicaffeoylquinic Acid
Quercetin 3-O-Sophoroside
Isorhamnetin 3-O-Glucoside 7-O-Rhamnoside
Isorhamnetin 3-O-Rutinoside
Isorhamnetin 7-O-Rhamnoside
Didymin
Hesperidin
Narirutin
Neohesperidin
Poncirin
Nobiletin
Sinensetin
3-Methoxysinensetin
Kaempferide
Eriocitrin
Neoeriocitrin
Bergapten
Phlorin
Naringin 4'-O-Glucoside
Naringin 6'-Malonate
Narirutin 4'-O-Glucoside
Neodiosmin
Rhoifolin
Rhoifolin 4'-O-Glucoside
Diosmin
Luteolin 7-O-Rutinoside
Apigenin 6,8-Di-C-Glucoside
Tetramethylscutellarein
3-Methoxynobiletin
Chrysin
Cinnamoyl Glucose
Kaempferol 3-O-Rhamnoside
Delphinidin 3,5-O-Diglucoside
Punicalagin
Pelargonidin 3,5-O-Diglucoside
P-Anisaldehyde
Anethole
Theaflavin 3'-O-Gallate
Theaflavin 3,3'-O-Digallate
Theaflavin 3-O-Gallate
Luteolin 7-O-Diglucuronide
Verbascoside
6''-O-Acetyldaidzin
6''-O-Acetylgenistin
6''-O-Acetylglycitin
6''-O-Malonyldaidzin
6''-O-Malonylgenistin
6''-O-Malonylglycitin
Daidzin
Genistin
Glycitein
Glycitin
Coumestrol
Kaempferol 3-O-Glucosyl-Rhamnosyl-Galactoside
Kaempferol 3-O-Glucosyl-Rhamnosyl-Glucoside
Myricetin 3-O-Galactoside
Quercetin 3-O-Glucosyl-Rhamnosyl-Galactoside
Quercetin 3-O-Glucosyl-Rhamnosyl-Glucoside
Quercetin 3-O-Rhamnosyl-Galactoside
24-Methylcholestanol Ferulate
24-Methylcholesterol Ferulate
24-Methylenecholestanol Ferulate
24-Methyllathosterol Ferulate
Schottenol Ferulate
Sitosterol Ferulate
Stigmastanol Ferulate
1-Acetoxypinoresinol
3,4-Dhpea-Ea
3,4-Dhpea-Eda
Ligstroside
Ligstroside-Aglycone
Oleuropein-Aglycone
P-Hpea-Ea
P-Hpea-Eda
Hydroxycaffeic Acid
3,4-Dihydroxyphenylglycol
3,4-Dhpea-Ac
Apigenin 7-O-Glucoside
Luteolin 7-O-Glucoside
Demethyloleuropein
Hydroxytyrosol 4-O-Glucoside
Oleoside 11-Methylester
Oleoside Dimethylester
P-Hpea-Ac
Homoveratric Acid
4-Vinylsyringol
Sinapine
Sesaminol
Sesamol
Sesamolin
Sesamolinol
Episesamin
Episesaminol
3-Methoxyacetophenone
2-Methoxy-5-Prop-1-Enylphenol
Apigenin 7-O-(6''-Malonyl-Apiosyl-Glucoside)
Apigenin 7-O-Apiosyl-Glucoside
Chrysoeriol 7-O-(6''-Malonyl-Apiosyl-Glucoside)
Chrysoeriol 7-O-(6''-Malonyl-Glucoside)
Chrysoeriol 7-O-Apiosyl-Glucoside
Chrysoeriol 7-O-Glucoside
Luteolin 7-O-(2-Apiosyl-6-Malonyl)-Glucoside
Luteolin 7-O-(2-Apiosyl-Glucoside)
Luteolin 7-O-Malonyl-Glucoside
Cirsimaritin
Hispidulin
Kaempferol 3-O-Rhamnosyl-Rhamnosyl-Glucoside
Quercetin 3-O-Rhamnosyl-Rhamnosyl-Glucoside
Carnosic Acid
Rosmanol
Rosmarinic Acid
Cirsilineol
Eupatorin
Jaceosidin
Nepetin
Dihydroquercetin
Pinocembrin
Sakuranetin
6-Hydroxyluteolin
6-Hydroxyluteolin 7-O-Rhamnoside
Scutellarein
Methylgalangin
Acetyl Eugenol
Estragole
Eugenol
[6]-Gingerol
Carnosol
Carvacrol
Epirosmanol
Rosmadial
Thymol
Baicalein
Caffeic Acid Ethyl Ester
P-Coumaric Acid Ethyl Ester
P-Coumaroyl Tartaric Acid Glucosidic Ester
Coumarin
Curcumin
Naringenin 7-O-Glucoside
6,8-Dihydroxykaempferol
Isorhamnetin 3-O-Galactoside
Isohydroxymatairesinol
Anhydro-Secoisolariciresinol
Todolactol A
Delphinidin 3-O-Feruloyl-Glucoside
Petunidin 3,5-O-Diglucoside
Petunidin 3-O-Rhamnoside
Kaempferol 3-O-Acetyl-Glucoside
Kaempferol 3-O-Xylosyl-Glucoside
P-Coumaroyl Glycolic Acid
P-Coumaroyl Malic Acid
Resveratrol 5-O-Glucoside
(+)-Catechin 3-O-Glucose
Gallic Aldehyde
Kaempferol 3,7-O-Diglucoside
Kaempferol 3-O-Sophoroside
1,2'-Disinapoyl-2-Feruloylgentiobiose
1,2,2'-Triferuloylgentiobiose
1,2,2'-Trisinapoylgentiobiose
1,2-Diferuloylgentiobiose
1,2-Disinapoylgentiobiose
1-Sinapoyl-2,2'-Diferuloylgentiobiose
1-Sinapoyl-2-Feruloylgentiobiose
Isorhoifolin
Luteolin 6-C-Glucoside
Dihydro-P-Coumaric Acid
Methoxyphenylacetic Acid
Dihydrocaffeic Acid
Chicoric Acid
Luteolin 7-O-Glucuronide
Kaempferol 3-O-(6"-Malonyl-Glucoside)
Quercetin 3-O-(6"-Malonyl-Glucoside)
Quercetin 3-O-(6"-Malonyl-Glucoside) 7-O-Glucoside
5,3',4'-Trihydroxy-3-Methoxy-6:7-Methylenedioxyflavone 4'-O-Glucuronide
5,4'-Dihydroxy-3,3'-Dimethoxy-6:7-Methylenedioxyflavone 4'-O-Glucuronide
Jaceidin 4'-O-Glucuronide
Patuletin 3-O-(2''-Feruloylglucosyl)(1->6)-[Apiosyl(1->2)]-Glucoside
Patuletin 3-O-Glucosyl-(1->6)-[Apiosyl(1->2)]-Glucoside
Spinacetin 3-O-(2"-Feruloylglucosyl)(1->6)-[Apiosyl(1->2)]-Glucoside
Spinacetin 3-O-(2"-P-Coumaroylglucosyl)(1->6)-[Apiosyl(1->2)]-Glucoside
Spinacetin 3-O-Glucosyl-(1->6)-Glucoside
Spinacetin 3-O-Glucosyl-(1->6)-[Apiosyl(1->2)]-Glucoside
Cyanidin 3-O-(6''-Malonyl-3''-Glucosyl-Glucoside)
Delphinidin 3-O-Glucosyl-Glucoside
Isorhamnetin 4'-O-Glucoside
Quercetin 3,4'-O-Diglucoside
Quercetin 4'-O-Glucoside
Quercetin 7,4'-O-Diglucoside
Butein
7,3',4'-Trihydroxyflavone
7,4'-Dihydroxyflavone
Geraldone
Kaempferol 3-O-(2''-Rhamnosyl-6''-Acetyl-Galactoside) 7-O-Rhamnoside
Kaempferol 3-O-(2''-Rhamnosyl-Galactoside) 7-O-Rhamnoside
Kaempferol 3-O-(6''-Acetyl-Galactoside) 7-O-Rhamnoside
Kaempferol 3-O-Galactoside 7-O-Rhamnoside
Kaempferol 7-O-Glucoside
Quercetin 3-O-(6''-Acetyl-Galactoside) 7-O-Rhamnoside
Quercetin 3-O-Galactoside 7-O-Rhamnoside
Kaempferol 3-O-Xylosyl-Rutinoside
Quercetin 3-O-Xylosyl-Rutinoside
3,4-Diferuloylquinic Acid
3,5-Diferuloylquinic Acid
Apigenin 7-O-Glucuronide
Isopimpinellin
Psoralen
Xanthotoxin
composition_fobi %>%
filter(is.na(name)) %>%
filter(!duplicated(compound)) %>%
pull(compound) %>%
str_to_title() %>%
cat(sep = "\n")
library(tidyverse)
library(tidyverse)
composition <- readxl::read_xlsx("data/composition-data.xlsx") %>%
rownames_to_column()
foods_fobitools <- fobitools::annotate_foods(foods = composition[, c(1,4)])
annotated_foods <- foods_fobitools$annotated %>%
dplyr::rename(food = FOOD_NAME)
composition_fobi <- composition %>%
right_join(annotated_foods, by = "food") %>%
select(FOBI_ID, FOBI_NAME, food, compound_group,
compound_sub_group, compound, publication_ids, pubmed_ids)
compounds <- readxl::read_xls("data/compounds.xls") %>%
select(Name, `ChEBI ID`, `PubChem ID`) %>%
dplyr::rename(compound = Name)
composition_fobi <- composition_fobi %>%
left_join(compounds, by = "compound") %>%
mutate(compound = tolower(compound))
metabolites_fobi <- fobitools::parse_fobi(terms = "FOBI:01501", get = "des") %>%
select(1:4) %>%
mutate(compound = tolower(name))
composition_fobi <- composition_fobi %>%
left_join(metabolites_fobi, by = "compound") %>%
filter(!duplicated(.))
composition_fobi %>%
filter(is.na(name)) %>%
filter(!duplicated(compound)) %>%
pull(compound) %>%
str_to_title() %>%
cat(sep = "\n")
composition_fobi
View(metabolites_fobi)
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv")
View(annotations_1)
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate_all(~ case_when(., "No result", 3))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate_all(~ case_when("No result", 3))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate_all(case_when("No result", 3))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate_all(funs(case_when(. == "No result" | . == "undefined" ~ NA)))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate_all(list(case_when(. == "No result" | . == "undefined" ~ NA)))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate_all(list(case_when(. == "No result" | . == "undefined" ~ NA)))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate(across(cols = everything(), ~ case_when(. == "No result" | . == "undefined" ~ NA)))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate(across(cols = everything(), ~ ifelse(. == "No result" | . == "undefined", NA, .)))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
mutate(across(cols = ., ~ ifelse(. == "No result" | . == "undefined", NA, .)))
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
na_if("No result")
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
na_if("No result" | "undefined")
annotations_1 <- readr::read_csv("data/cts-20210714170715.csv") %>%
na_if("No result") %>%
na_if("undefined")
table(annotations_1$Score)
annotations_2 <- readr::read_csv("data/cts-20210714172629.csv") %>%
na_if("No result") %>%
na_if("undefined")
View(annotations_2)
annotations <- left_join(annotations_1, annotations_2, by = "Chemical Name")
View(annotations)
annotations <- left_join(annotations_1, annotations_2, by = "Chemical Name") %>%
select(-Score)
library(classyfireR)
install.packages('classyfireR')
remotes::install_github('aberHRML/classyfireR', build_vignettes = FALSE')
)
)
(/)
7
76
''
remotes::install_github('aberHRML/classyfireR', build_vignettes = 'FALSE')
library(classyfireR)
df <- list()
for(i in 1:nrow(annotations)){
df[[i]] <- get_classification(annotations$InChIKey[i])
Sys.sleep(5)
}
annotations_nona <- annotations %>%
filter(!is.na(InChIKey))
df <- list()
View(annotations_nona)
for(i in 1:nrow(annotations_nona)){
df[[i]] <- get_classification(annotations_nona$InChIKey[i])
Sys.sleep(5)
}
i<-1
get_classification(annotations_nona$InChIKey[i])
?get_classification
annotations_nona$InChIKey[i]
get_classification('MDHYEMXUFSJLGV-UHFFFAOYSA-B')
library(classyfireR)
library(classyfireR)
purrr::map(annotations_nona$InChIKey, get_classification)
df <- purrr::map(annotations_nona$InChIKey, get_classification)
na_if
df <- purrr::map(annotations_nona$InChIKey[1], get_classification)
